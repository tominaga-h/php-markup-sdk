#!/usr/bin/env php
<?php

require_once __DIR__ . '/../vendor/autoload.php';

use Hytmng\MarkupSdk\Lexer\Lexer;
use Hytmng\MarkupSdk\Token\TextToken;
use Hytmng\MarkupSdk\Token\SpaceToken;
use Hytmng\MarkupSdk\Token\HashToken;
use Hytmng\MarkupSdk\Token\AsteriskToken;
use Hytmng\MarkupSdk\Token\HyphenToken;
use Hytmng\MarkupSdk\Token\NewlineToken;
use Hytmng\MarkupSdk\Parser\Parser;
use Hytmng\MarkupSdk\Parser\TokenStream;
use Hytmng\MarkupSdk\Ast\Interpreter\Markdown\HeadingInterpreter;
use Hytmng\MarkupSdk\Ast\Interpreter\Markdown\ListInterpreter;
use Hytmng\MarkupSdk\Ast\Interpreter\Markdown\BoldInterpreter;
use Hytmng\MarkupSdk\Ast\Interpreter\TextInterpreter;

$lexer = new Lexer();
$lexer->registerTokens([
    new TextToken(),
    new SpaceToken(),
    new HashToken(),
    new AsteriskToken(),
    new HyphenToken(),
    new NewlineToken(),
]);

$input = "# Hello, **World**";
echo "input: $input\n";
$tokens = $lexer->tokenize($input);
print_r($tokens);
echo "--------------------------------\n";

$parser = new Parser();
$parser->registerInterpreters([
    new TextInterpreter(),
    new HeadingInterpreter(),
    new ListInterpreter(),
    new BoldInterpreter(),
]);

$document = $parser->parse(new TokenStream($tokens));
print_r($document);
echo "--------------------------------\n";
var_dump($document->toHtml());
